<div ng-controller="reportsController">
	<h1>Reportes</h1>
	<div class="line-through"></div>

	<accordion>

		<!-- Usuarios registrados entre dos fechas -->
		<accordion-group heading="Usuarios registrados entre dos fechas">
		<div class="row">
			<div class="col-xs-12 col-sm-12 col-md-3">
				<form name="userRegistered">
					<h4>Desde: </h4>
					<div class="form-group">
						<input type="number" name="dayFrom" class="form-control" ng-model="date_report.from.day" placeholder="Día (1..31)" min=1 max=31 required>
						<div class="alert alert-danger" role="alert" 
						ng-show="!userRegistered.dayFrom.$valid && !userRegistered.dayFrom.$pristine">
						Por favor ingresa un día comprendido entre 1 y 31.
					</div>
				</div>
				<div class="form-group">
					<input type="number" name="monthFrom" class="form-control" ng-model="date_report.from.month" placeholder="Mes (1..12)" min=1 max=12 required>
					<div class="alert alert-danger" role="alert" 
					ng-show="!userRegistered.monthFrom.$valid && !userRegistered.monthFrom.$pristine">
					Por favor ingresa un mes comprendido entre 1 y 12.
				</div>
			</div>
			<div class="form-group">
				<input type="number" name="fromYear" class="form-control" ng-model="date_report.from.year" placeholder="Año (2015..2050)" min=2015 max=2050 required>
				<div class="alert alert-danger" role="alert" 
				ng-show="!userRegistered.fromYear.$valid && !userRegistered.fromYear.$pristine">
				Por favor ingresa un año comprendido entre 2015 y 2050.
			</div>
		</div>

		<h4>Hasta: </h4>

		<div class="form-group">
			<input type="number" name="toDay" class="form-control" ng-model="date_report.to.day"
			placeholder="Día (1..31)" min=1 max=31 required>
			<div class="alert alert-danger" role="alert" 
			ng-show="!userRegistered.toDay.$valid && !userRegistered.toDay.$pristine">
			Por favor ingresa un día comprendido entre 1 y 31.
		</div>
	</div>
	<div class="form-group">
		<input type="number" name="toMonth" class="form-control" ng-model="date_report.to.month" placeholder="Mes (1..12)" min=1 max=12 required>
		<div class="alert alert-danger" role="alert" 
		ng-show="!userRegistered.toMonth.$valid && !userRegistered.toMonth.$pristine">
		Por favor ingresa un mes comprendido entre 1 y 12.
	</div>
</div>
<div class="form-group">
	<input type="number" name="toYear" class="form-control" ng-model="date_report.to.year" placeholder="Año (2015..2050)" min=2015 max=2050 required>
	<div class="alert alert-danger" role="alert" 
	ng-show="!userRegistered.toYear.$valid && !userRegistered.toYear.$pristine">
	Por favor ingresa un año comprendido entre 2015 y 2050.
</div>
</div>
</form>
<div class="form-group">
	<button type="button" class="btn btn-success" ng-disabled="!userRegistered.$valid" ng-click="
	userRegistered.$valid &&user_report(date_report)">Obtener reporte</button>
</div>
</div>
<div class="col-xs-12 col-sm-12 col-md-9">
	<table class="table table-striped">
		<tr>
			<th>ID Usuario</th>
			<th>Nombre</th>
			<th>Apellido</th>
			<th>Correo electrónico</th>
		</tr>
		<tr ng-repeat="user in users_report" ng-init="count_number_of_users()">
			<td>{{user._id}}</td>
			<td>{{user.name}}</td>
			<td>{{user.lastname}}</td>
			<td>{{user.email}}</td>
		</tr>
	</table>
	<p class="text-center"><strong>Total : {{total_usuarios_registrados}}</strong></p>
</div>
</div>
</accordion-group>

<!-- Reporte de ventas entre dos fechas -->
<accordion-group heading="Reporte de ventas entre dos fechas">
<div class="row">
	<div class="col-xs-12 col-sm-12 col-md-3">
		<form name="salesBetweenDates">
			<h4>Desde: </h4>
			<div class="form-group">
				<input type="number" name="dayFrom" class="form-control" ng-model="sales_between_dates.from.day" placeholder="Día (1..31)" min=1 max=31 required>
				<div class="alert alert-danger" role="alert" 
				ng-show="!salesBetweenDates.dayFrom.$valid && !salesBetweenDates.dayFrom.$pristine">
				Por favor ingresa un día comprendido entre 1 y 31.
			</div>
		</div>
		<div class="form-group">
			<input type="number" name="monthFrom" class="form-control" ng-model="sales_between_dates.from.month" placeholder="Mes (1..12)" min=1 max=12 required>
			<div class="alert alert-danger" role="alert" 
			ng-show="!salesBetweenDates.monthFrom.$valid && !salesBetweenDates.monthFrom.$pristine">
			Por favor ingresa un mes comprendido entre 1 y 12.
		</div>
	</div>
	<div class="form-group">
		<input type="number" name="fromYear" class="form-control" ng-model="sales_between_dates.from.year" placeholder="Año (2015..2050)" min=2015 max=2050 required>
		<div class="alert alert-danger" role="alert" 
		ng-show="!salesBetweenDates.fromYear.$valid && !salesBetweenDates.fromYear.$pristine">
		Por favor ingresa un año comprendido entre 2015 y 2050.
	</div>
</div>

<h4>Hasta: </h4>

<div class="form-group">
	<input type="number" name="toDay" class="form-control" ng-model="sales_between_dates.to.day"
	placeholder="Día (1..31)" min=1 max=31 required>
	<div class="alert alert-danger" role="alert" 
	ng-show="!salesBetweenDates.toDay.$valid && !salesBetweenDates.toDay.$pristine">
	Por favor ingresa un día comprendido entre 1 y 31.
</div>
</div>
<div class="form-group">
	<input type="number" name="toMonth" class="form-control" ng-model="sales_between_dates.to.month" placeholder="Mes (1..12)" min=1 max=12 required>
	<div class="alert alert-danger" role="alert" 
	ng-show="!salesBetweenDates.toMonth.$valid && !salesBetweenDates.toMonth.$pristine">
	Por favor ingresa un mes comprendido entre 1 y 12.
</div>
</div>
<div class="form-group">
	<input type="number" name="toYear" class="form-control" ng-model="sales_between_dates.to.year" placeholder="Año (2015..2050)" min=2015 max=2050 required>
	<div class="alert alert-danger" role="alert" 
	ng-show="!salesBetweenDates.toYear.$valid && !salesBetweenDates.toYear.$pristine">
	Por favor ingresa un año comprendido entre 2015 y 2050.
</div>
</div>
</form>
<div class="form-group">
	<button type="button" class="btn btn-success" ng-disabled="!salesBetweenDates.$valid" ng-click="
	salesBetweenDates.$valid && sales_report(sales_between_dates)">Obtener reporte</button>
</div>
</div>
<div class="col-xs-12 col-md-9">
	<table class="table table-striped">
		<tr>
			<th>ID Oferta</th>
			<th>Necesidad</th>
			<th>Monto ofertado</th>
		</tr>
		<tr ng-repeat="offer in sales_report_data" ng-init="count_number_of_sales_between_dates()">
			<td>{{offer._id}}</td>
			<td>{{offer.description}}</td>
			<td>{{offer.offer | currency: "$ "}}</td>
		</tr>
	</table>
	<p class="text-center"><strong>Total : {{total_sales_between_dates}}</strong></p>
</div>
</div>
</accordion-group>


<!-- Reporte por mes -->
<accordion-group heading="Reporte de ventas por mes">
<div class="row">
	<div class="col-xs-12 col-sm-12 col-md-3">
		<form name="salesPerMonth">
			<h4>Selecciona el mes: </h4>
			<div class="form-group">
				<input type="number" name="monthFrom" class="form-control" ng-model="sales_in_month.from.month" placeholder="Mes (1..12)" min=1 max=12 required>
				<div class="alert alert-danger" role="alert" 
				ng-show="!salesPerMonth.monthFrom.$valid && !salesPerMonth.monthFrom.$pristine">
				Por favor ingresa un mes comprendido entre 1 y 12.
			</div>
		</div>
		<div class="form-group">
			<input type="number" name="fromYear" class="form-control" ng-model="sales_in_month.from.year" placeholder="Año (2015..2050)" min=2015 max=2050 required>
			<div class="alert alert-danger" role="alert" 
			ng-show="!salesPerMonth.fromYear.$valid && !salesPerMonth.fromYear.$pristine">
			Por favor ingresa un año comprendido entre 2015 y 2050.
		</div>
	</div>
	<div class="form-group">
		<button type="button" class="btn btn-success" ng-disabled="!salesPerMonth.$valid" 
		ng-click="sales(sales_in_month)">Obtener reporte</button>
	</div>
</form>
</div>
<div class="col-xs-12 col-md-9">
	<table class="table table-striped">
		<tr>
			<th>ID Oferta</th>
			<th>Necesidad</th>
			<th>Monto ofertado</th>
		</tr>
		<tr ng-repeat="offer in sales_per_month_report" ng-init="calculateTotal(offer.offer)">
			<td>{{offer._id}}</td>
			<td>{{offer.description}}</td>
			<td>{{offer.offer | currency: "$ "}}</td>
		</tr>
	</table>
	<p class="text-center"><strong>Total : {{total | currency: "$ "}}</strong></p>
</div>
</div>
</accordion-group>

<!-- Reporte comisiones por mes -->
<accordion-group heading="Reporte de comisiones por mes">
<div class="row">
	<div class="col-xs-12 col-sm-12 col-md-3">
		<form name="comissionPerMonth">
			<h4>Selecciona el mes: </h4>
			<div class="form-group">
				<input type="number" name="monthFrom" class="form-control" ng-model="commision_per_month.from.month" placeholder="Mes (1..12)" min=1 max=12 required>
				<div class="alert alert-danger" role="alert" 
				ng-show="!comissionPerMonth.monthFrom.$valid && !comissionPerMonth.monthFrom.$pristine">
				Por favor ingresa un mes comprendido entre 1 y 12.
			</div>
		</div>
		<div class="form-group">
			<input type="number" name="fromYear" class="form-control" ng-model="commision_per_month.from.year" placeholder="Año (2015..2050)" min=2015 max=2050 required>
			<div class="alert alert-danger" role="alert" 
			ng-show="!comissionPerMonth.fromYear.$valid && !comissionPerMonth.fromYear.$pristine">
			Por favor ingresa un año comprendido entre 2015 y 2050.
		</div>
	</div>
	<div class="form-group">
		<button type="button" class="btn btn-success" ng-disabled="!comissionPerMonth.$valid" 
		ng-click="commision_per_month(commision_per_month)">Obtener reporte</button>
	</div>
</form>
</div>
<div class="col-xs-12 col-md-9">
	<table class="table table-striped">
		<tr>
			<th>ID Oferta</th>
			<th>Necesidad</th>
			<th>Comisión Ganada</th>
		</tr>
		<tr ng-repeat="offer in commision_per_month_report" ng-init="calculateCommisionTotal(offer.offer)">
			<td>{{offer._id}}</td>
			<td>{{offer.description}}</td>
			<td>{{offer.offer * 0.3 | currency: "$ "}}</td>
		</tr>
	</table>
	<p class="text-center"><strong>Total : {{total_commission * 0.3 | currency: "$ "}}</strong></p>
</div>
</div>
</accordion-group>
</accordion>
</div>
